<h1>Spoejs channels at this site:</h1>
% foreach my $chan ( @channels ) {
<a href="/<% $chan->channel_dir() %>/index.html">
<h2><% $chan->get( 'title' ) %></h2>
</a>

% if ( $chan->{S} ) {
% $spoejs{channel_path} = $chan->{path};
% $spoejs{channel} = $chan->channel_dir();
<& /w, w => 'abstract', storyref => $chan->{S} &>
% } else {
No stories.
% }
<br/>
<br/>
<br/>
% }
<hr/>
Administration:
<br/>
<a href="/htm/admin/siteconfig.html">
Site configuration
</a>
<%init>
my $CL = new Spoejs::ChannelList( path => "$ENV{DOCUMENT_ROOT}/users/",
                                  lang => $spoejs{lang_handle} );
$spoejs{error}{$m->current_comp->source_file} = $CL->{msg} if $CL->{msg};

# Gives array of ChannelConf object refs
my @channels;
my @auth =  keys %{$session{chanauth}} if defined $session{chanauth};
@channels = $CL->newest_channels( auth => \@auth )
  unless $CL->{msg};
</%init>
