%# Show a story with all it's details and media
%#
%# License: Artistic License
%#          http://www.opensource.org/licenses/artistic-license.php
%#
%# $Id: story-page,v 1.21 2004/05/17 13:52:18 snicki Exp $
%#
<h2><% $story_ref->get( 'title' ) %></h2>
<&| /w, w => "box", heading => $story_ref->get( 'title' ) &>
<&| /l &>date</&>:
<% $story_ref->get( 'date' ) %>
<br/>
<br/>
%# XXX: use below line when 'summary' is added to resource.txt
%#<&| /w, w => "box", heading => $m->comp( '/l', l => 'summary' ) &>
<&| /w, w => "box", heading => '*Summary*' &>
<& /w, w => "text", text=>$story_ref->get( 'abstract' ) &>
</&>
<br/>
<br/>
% my $text = $story_ref->get( 'fulltext' );
%# XXX: use below line when 'story' is added to resource.txt
%#<&| /w, w => "box", heading => $m->comp( '/l', l => 'story' ) &>
<&| /w, w => "box", heading => '*Story*' &>
<& /w, w => "text", text => $text &>
</&>
% unless ( $text =~ /media=/ig ) { #XXX: Consider other ways...
<br/>
<br/>
<&| /w, w => 'box', heading => $m->comp( '/l', l => 'media' ) &>
<& /w, w => 'album', media_list => $media_list, %navi_opt &>
</&>
<& /w, w => 'navi', %navi_opt &>
% }	
<br/>
<br/>
<br/>
% if ( $edit_href ) {
<a href="<% $edit_href %>"><&|/l&>edit</&></a>
% }
</&>
<%args>
  $story_dir  => undef
  $story_ref  => undef
  $edit_href  => undef
  %navi_opt   => undef
  $media_list => undef
</%args>
