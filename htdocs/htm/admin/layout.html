<%doc>
Edit layout of channel

License: Artistic License
         http://www.opensource.org/licenses/artistic-license.php

$Id: layout.html,v 1.9 2004/06/16 11:23:18 sauber Exp $
</%doc>
<& journal_tab.mas &>
<br/>
<fieldset>
<legend>
**journal_layout**
</legend>
<&| /htm/admin/fill_in_form.mas, data => \%ARGS, spec => $spec &>
<form name="layout_form" method="post" action="">

**thumb_count**:
<select name="thumb_count">

%for my $opt ( @thum_count_options ) {

<option value="<% $opt->[0] %>"><% $opt->[1] %></option>

% }

</select>
**thumb_count_description**
<br/>
<br/>
<input type="submit" name="submit" value="**submit**">
</form>
</&>
</fieldset>
<%init>
# Check authorization
return undef unless $m->comp( '/htm/login.html:check_login' );

my @attributes = qw( thumb_count );

my @thum_count_options = ( [ -1, '**theme_default**' ], [ 0, '**all**' ],
                           [ 10, 10 ],  [ 20, 20 ], [ 50, 50 ] );

my $error;
my $spec = { thumb_count => { regexp      => '^-?\d+$',
                              error       => '**invalid_thumb_count**' },
           };

# Process submission
if ( defined $ARGS{submit} ) {

  # Check for errors
  $error = $m->comp( '/htm/admin/error.mas:error_check', \%ARGS, $spec, 
                     'layout_form' );

  # Save data
  unless ( $error ) {
    for my $attrib ( @attributes ) {
      $spoejs{ChannelConf}->set( $attrib => $ARGS{$attrib} );
    }
  }
}

# Fill in ARGS
if ( defined $spoejs{ChannelConf} )
{
  for my $attrib ( @attributes ) {
    $ARGS{$attrib} = $spoejs{ChannelConf}->get( $attrib );
  }
}
</%init>
