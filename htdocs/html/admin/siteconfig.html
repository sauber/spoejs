<h1>Status for channels at this site:</h1>
<form method="post" action="">
<table width="100%">
<tr>
<th>Shortname</th><th>Title</th><th>Public</th><th>Approved</th>
</tr>
% foreach my $chan ( @channels ) {
<tr>
<td><% $chan->get( 'shortname' ) %></td>
<td><a href="/<% $chan->channel_dir() %>/index.html">
<% $chan->get( 'title' ) %></a>
</td>
<td align="center"><% $chan->get( 'public' ) %></td>
<td align="center">
<select name="<% $chan->get( 'shortname' ) %>">
% while ( my ( $k, $v ) = each %yn ) {
<option value="<% $k %>"<% $chan->get( 'approved' ) eq $k ? 
                                               ' selected="selected">' : '>' %>
<%$v %>
</option>
% }
</select>
</td></tr>
% }
</table>
<input type="submit"/>
</form>

<%init>
my %yn = ( yes => 'Yes', no => 'No' );

my $CL = new Spoejs::ChannelList( path => "$ENV{DOCUMENT_ROOT}/users/",
                                  lang => $spoejs{lang_handle} );

# Get array of ChannelConf object refs
my @channels = $CL->search_channels();

# Set the new status
foreach my $chan ( @channels ) {
 $chan->set( approved => $ARGS{$chan->get('shortname')} );
}

</%init>
